<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>threejs场景</title>
	<meta name="keywords" content="">
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">

	<link rel="stylesheet" href="../../css/common.css">
	<script src="../../js/myGetUserMedia.js" charset="utf-8"></script>

    <script src="../../js/lib/three.js" charset="utf-8"></script>
	<script src="../../js/my-three.js" charset="utf-8"></script>

	<script src="../../js/lib/stats.js" charset="utf-8"></script>
	<script src="../../js/MyStats.js" charset="utf-8"></script>

	<script src="../../js/lib/OrbitControls.js" charset="utf-8"></script>

	<script src="../../js/procupine.js" charset="utf-8"></script>

	<style>
	.btns-con{position:fixed; right:1em; bottom:1em;}
	video#video{z-index:-1;}
	</style>
</head>
<body>
	<video id="video" autoplay="" playsinline muted></video>
	<div class="btns-con">
		<input id="shift" type="button" value="切换 ⇌"/>
		<input id="play" type="button" value="开始 ▶"/>
		<input id="stop" type="button" value="停止 ■"/>
	</div>

	<script src="../video-stream/js/MediaDevices-getUserMedia.js" charset="utf-8"></script>

	<script type="text/javascript">
		var globalController = {
			x: 0,
			y: 0,
			z: 0
		};
	</script>

	<script type="text/javascript">
		var myStats = new MyStats;

		var scene = new Scene();
		var renderer = new Renderer();
		var camera = new Camera({
			position: {
				y: 2
			}
		});

		var cube = new Cube({
			size: {
				x: 2,
				y: 1,
				z: 3
			},
			material: {
				texture: {
					url: '/img/texture-1.png'
				}
			},
			position: {
				y: 2
			}
		});

		var cube2 = new Cube({
			material: {
				color: 0x00ff00,
			},
			position: {
				x: 2
			}
		});

		var group = new Group({
			children: [cube, cube2],
			position: {
				z: -10
			}
		});
		scene.add(group);

		var helper = new THREE.GridHelper( 100, 50 );
		scene.add( helper );

		var dirLight = new THREE.DirectionalLight(0xffffff, 1);
		dirLight.position.set(1, 1, 1);
		scene.add(dirLight);

		var loader = new THREE.FontLoader();
		loader.load( '../three-objects/json/FeHelper-20191104164827.json', function ( font ) {
			var test = new TextGeometry({
				font: font,
				position: {
					z: -12
				}
			});
			scene.add(test);
		} );

		new Animation({
			scene: scene,
			renderer: renderer,
			camera: camera,
			stats: myStats,
			callback: function() {
				cube.rotation.y += 0.1;
				cube2.rotation.x += 0.1;
				// camera.rotation.y += .01;
				//
				scene.rotation.x = - globalController.x / 180 * Math.PI;
				scene.rotation.y = globalController.y / 180 * Math.PI;
				scene.rotation.z = - globalController.z / 180 * Math.PI;
			}
		});

		new Raycaster({
			camera: camera,
			scene: scene,
			handler: function(item) {
				item.scale.set(2, 2, 2);
			}
		})
	</script>

	<script type="text/javascript">
	new Pro({
		mode: 'drag',
		handler: function(obj) {
			globalController = obj;
		}
	})
	</script>
</body>
</html>
